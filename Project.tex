%
%  Allocating optional modules to University of York students
%
%  BSc Computer Science/Maths final-year dissertation
%
%  Created by Alex Muller on 2011-10-10.
%  Copyright (c) 2011 Alex Muller. All rights reserved.
%
\documentclass[draft]{scrartcl}
% article, report, scrartcl, uoy_cs/UoYCSproject ?

\usepackage[utf8]{inputenc} % Use utf-8 encoding for foreign characters

% Pages and margins
\usepackage{fullpage}
% Inside and top margins should be a minimum of 2cm; other margins should be a
% minimum of 1cm. You might find it simplest to leave 2cm all round.
\usepackage[top=2cm, bottom=4cm, left=2cm, right=2cm]{geometry}

\setlength{\parskip}{0.15cm plus 0.1cm minus 0.05cm}
% \addtolength{\parskip}{\baselineskip}
% \usepackage{parskip}

% \usepackage{fancyhdr} % Running Headers and footers
% \usepackage{subfigure} % Multipart figures
% \usepackage{amsmath,amssymb,latexsym} % More symbols

\usepackage{boxedminipage} % Surround parts of graphics with box
\usepackage{lastpage} % Number of pages

\usepackage{xcolor} % Syntax highlighting etc
\definecolor{light-gray}{gray}{0.5}
\definecolor{yorkblue}{RGB}{0,38,99}
\definecolor{yorkgreen}{RGB}{24,69,59}

% Each section should start on a new page
\let\stdsection\section
\renewcommand\section{\clearpage\stdsection}

% Listings package for including code
\usepackage{listings}
\lstset{
  basicstyle = \ttfamily\footnotesize,
  % keywordstyle = \color{blue},
  % commentstyle = \color{red},
  numbers = left,
  numberstyle = \tiny,
  stepnumber = 20,
  numbersep = 12pt,
  frame = single,
  rulecolor = \color{light-gray},
}
\lstloadlanguages{HTML}

\usepackage{upquote}

\usepackage{algorithmic}

% This is now the recommended way for checking for PDFLaTeX:
\usepackage{ifpdf}

\ifpdf
\usepackage[pdftex]{graphicx}
\else
\usepackage{graphicx}
\fi

\ifpdf
\usepackage[pdftex]{hyperref}
\else
\usepackage{url}
\fi

\ifpdf
\usepackage{pdflscape}
\else
\usepackage{lscape}
\fi

\usepackage{pdfpages}

\usepackage{ifdraft}

\usepackage{libs/tikz-er2} % Entity-relationship diagrams
\usepackage{libs/gantt} % Gantt chart


% Glossary
\usepackage[toc]{glossaries}
\makeglossaries
\input{references/glossary.tex}

% Title page stuff

\def\paperauthor{Alexander Muller}
\def\papertitle{Allocating optional modules \\ to University of York students}
\def\paperlength{14,039}

\title{\papertitle}
\author{\paperauthor}
\date{\today}

% PDF Properties

\hypersetup{
  pdftitle = {\papertitle},
  pdfauthor = {\paperauthor},
  pdfsubject = {A final-year BSc Computer Science project to allocate university modules},
  pdfkeywords = {york, computer science, webapp, university, module, allocation}
}


\begin{document}

\ifpdf
\DeclareGraphicsExtensions{.pdf, .jpg, .tif}
\else
\DeclareGraphicsExtensions{.eps, .jpg}
\fi

\maketitle

This is the report for a Bachelor of Science final-year project in Computer
Science and Mathematics at the University of York. The project was supervised
by Dr James Cussens, Senior Lecturer in the Artificial Intelligence Group,
Department of Computer Science.

This report is \paperlength{} words, as counted by running \texttt{detex} and
\texttt{wc -w}. It is \pageref{LastPage} pages long. The word count does not
include any of the files or code listings in the appendices.

% The limits are 35,000 words and 70 pages - neither limit may be exceeded.
% Other projects I've seen have been 12,000/60, 11,000/60, 21,000/71 etc

The author is very grateful for all the assistance provided by the staff and
students at the University of York who were involved in the project, but
especially to James Cussens for his advice throughout and to Laura Crossley
for her management of the project on behalf of the University.

\clearpage

\begin{abstract}
  % Couple of paras. Not more than 200 words - this is 208.

  From the second year onwards, most students at the University of York can
  choose between two or more optional modules to tailor their academic career,
  in the hope that it will be more relevant, interesting and useful to them.
  
  There is currently no standard system for optional module allocation at the
  University of York. In some departments it is handled using a paper form
  which must be returned to departmental administrators and processed
  manually, which is a time-consuming process.
  
  This project aims to design and implement web-based software that can be
  used by departments and students to allocate modules more fairly and with
  less administrative overhead.
  
  Allocating modules ``fairly'' involves understanding how staff and students
  view fair allocation, and translating that into a constrained optimisation
  problem solvable by a computer.
  
  The web application is trialled by the Archaeology and History departments
  in Spring 2012 and, if successful, will be offered to all departments and
  maintained centrally by the University of York.
  
  This report discusses the choices made around the technology used, the
  development methodology and details relating to the allocation algorithm. It
  details specifics about the implementation, problems that arose and how they
  were mitigated, and some further work that could be carried out to improve
  the software.
\end{abstract}

\clearpage
\tableofcontents

\clearpage
\listoffigures
% \listoftables

\section{Statement of ethics}

% Informed consent

Those people volunteering to help with the project (interviewed during the
research stage) will at no point be put in a position of physical danger.
Consent will be obtained from all volunteers prior to their interview, and
volunteers' personal information will not be published or shared. A copy of
the consent form signed by all volunteers is given in
Appendix~\ref{sec:consent}.

Whenever a member of the University has been quoted by name in this project,
their explicit consent was obtained beforehand.

% Do no harm

As far as the project author is aware, there are no immediate ethical issues
relating to the creation of the module allocation software. However, there is
always the potential for any software to be repurposed.

% Confidentiality of data

The project steering group has noted that as a student, the author must not be
given access to any sensitive personal information. This includes, but is not
limited to, student names, email addresses and degree course information.
Development and testing of the software will be carried out with test data
that it is in a similar form to genuine student data held by the University.
The University's Data Protection Officer was consulted during the project, and
his input is discussed in Section~\ref{sec:dataprotection}.

The project author signed a \gls{nda} provided by \gls{itservices} in order to
clarify the situation regarding access to student data. A copy of this
\gls{nda} is provided in Appendix~\ref{sec:nda}. It states that the author
must not disclose confidential information he has obtained at any time.

\section{Introduction}

% The scope of the project, setting the scene for the remainder of the report.

A paper was presented by \gls{yusu} at \gls{utc} in March 2010 which discussed
student complaints and feedback around optional module allocation. The issues
raised in this paper were supported by student comments in the \gls{nss}, and
\gls{utc} established a working group to investigate improving the module
allocation process.

This project is the result of that investigation. It is sponsored by \gls{utc}
and is overseen in that regard by \gls{lc} of the \gls{aso}.

As well as being assessed as an undergraduate project, the software will be
evaluated independently by \gls{lc}. If it is judged to provide sufficient
advantages over the current methods of module allocation, it may be
recommended that responsibility for the software is handed to
\gls{itservices} and it is offered as a service to all departments.

\subsection{Report structure}

This section gives background information about the University of York
relevant to the project. Section~\ref{sec:requirements} discusses how the
project was run (with the help of administrative staff at the University) and
the requirements that were obtained from clients. Section~\ref{sec:research}
covers the research that was undertaken at the start of the project.
Section~\ref{sec:implementation} discusses the choices that were made during
the implementation of the software, and how it was tested before delivery.
Section~\ref{sec:furtherwork} describes ways in which the software could be
extended in the future. Section~\ref{sec:conclusions} gives the conclusions
drawn at the end of the project.

\subsection{The current state of module allocation}

% Refer to documents provided by LC
% (1) At the University of York

Universities worldwide want to give their students the most interesting and
useful education possible, and one way this can be accomplished is by offering
flexibility in modules students can take. Generally speaking, a department
that offers a broad range of modules to choose from will see increased student
satisfaction with the course.

At the University of York, module allocation is dealt with at the departmental
level. Some departments make use of centrally offered software (eVision and
\gls{sits}), though several departments feel the software is not flexible
enough and continue to use paper-based forms that must be filled out and
returned to the departmental office. A smaller number of departments that have
the resources to implement their own system, such as Computer Science, have
written their own module choice and allocation software.

At some universities in the United Kingdom (for example, the University of
Warwick and and the University of Leeds), enrolment is completed online, on a
first-come, first-served basis.

% (2) Elsewhere around the world

\subsection{Web applications at the University of York}
\label{sec:webapps_york}

% Student portal
% Timetabling gateway
% Google Apps for Education

The University is constantly improving the quality of web software available
to students and staff through providing updates to commercially obtained
software and employing developers to improve and maintain code written
in-house.

For the last few years, a \gls{sso} solution has been provided
centrally, using Shibboleth. This improves both user experience and security,
as users are encouraged to only ever enter their University username and
password into one screen, where the web address will always begin
\texttt{https://shib.york.ac.uk/}.

In September 2011, a new ``student portal'' was released, allowing students to
view personalised information relevant to them in one place. The application
was created by \gls{itservices} and was written in Java. Information on the
student portal is available at
\texttt{\href{https://www.york.ac.uk/students/about/}{www.york.ac.uk/students/about/}}.

For the beginning of the 2011--12 academic year, new timetabling software is in
use to give members of the University access to their complete timetable in
one location---something which has not been possible before.

In June 2012, the University will move all students to Google's Apps for
Education product for email and calendaring, one of the aims of which is to
improve the user experience dramatically over the current webmail software.

\input{sections/projmanagement_main.tex}

\input{sections/projmanagement_schedule.tex}

\input{sections/research_main.tex}

\subsection{Development methodology}

% Prototyping

Zhang and Chung \cite{MODFM_2003} note that prototyping can be used to
reinforce client confidence as well as making better use of the time allocated
to development and implementation.

Bochicchio and Paiano \cite{PrototypingWebApplications_2000} note that
creating prototypes of web applications has several advantages.
The most relevant advantage for this project is that a mockup can be used to
get feedback from non-technical stakeholders such as the project manager and
the departmental contacts.

Prototypes can be defined as being low or high fidelity depending on how much
they are designed to resemble the final application. Low fidelity prototypes
can be creating using a marker pen and sheets of blank paper, whereas higher
fidelity prototypes may be coded to appear in a web browser and allow the user
to interact as they might with the final system.

% Iterative

Iterative development (also sometimes referred to as ``rapid application
development'') is a process by which the product is gradually improved through
trial and error. This differs from processes such as the waterfall method,
where testing follows implementation, which follows design, which follows
gathering of requirements. The key advantage of following an iterative
development process is that it allows far more flexibility than other
methodologies; it is common in software development that the requirements may
change or be refined over the duration of the project, and the development
process should be able to adapt as necessary \cite{kuniavsky2003userexperience}.

Kuniavsky points out that an iterative development process is especially
suitable for web applications, as prototypes can be created quickly. A low
fidelity prototype of a web application (which might consist of sketched
wireframes) can be created in a matter of minutes, while slightly higher
fidelity prototypes such as a simplified application front-end can be running
in a web browser within a day.

An iterative development process for this project might involve background
research with users (in the form of interviews), the creation of a prototype,
refining the user experience through more interviews, and repeating the
``prototype $\rightarrow$ interview $\rightarrow$ refine user experience
$\rightarrow$ interview'' cycle.

\subsection{Database design}

A \gls{dbms} is software that manages the database, including providing the
ability to add or edit records stored in the database. The \gls{dbms} will be
one of the more mature products used in the creation of this system, with many
having been available since the 1990s.

Relational databases are a common feature of web applications. In meetings
with \gls{itservices} during the research stage, it was noted that the University
of York already deploys MySQL and Oracle (both relational model) database
systems for its web applications and \gls{mis}.

When designing a database, Johnson \cite{DatabaseModelsLanguagesDesign} gives
several questions that he believes must be answered before a database can be
created:

\begin{itemize}
  \item What are the entities that need to be stored by the database?
  \item What are the relationships between these entities?
  \item What constraints are there on the database?
  \item What kind of queries will be written against this database?
\end{itemize}

All the questions above are relevant during the design of the database. While
the first three questions relate to the structure of the database, the final
question is especially important regarding database performance.

His method involves drawing an entity-relationship diagram (as the name
implies, this answers the first two questions in the form of a graph) and then
translating the E-R diagram into the database schema, which includes deciding
which fields will become primary and foreign keys. Any constraints (such as
minimum or maximum lengths of strings) can then be added depending on the DBMS
product being used.

\subsection{Maintainability and the future of the software}
\label{sec:maintainability}

As the software created during this project will have to be maintained by the
University's \gls{itservices} if it is evaluated as successful, care must be
taken to ensure that the application is implemented in the most extensible and
maintainable way possible.

Principles of good software engineering apply equally to web applications as
to any other software project. There are several basic methods recommended by
Green and Ledgard \cite{Green:2011:CGF:2063166.2063168} for writing readable
and maintainable code. Their recommendations are designed around the
maintainer of the software having to do less work to understand the purpose of
a given piece of code. The recommendations could be summarised as:

\begin{itemize}
  \item Align parts of the code (e.g. equal signs) vertically when it makes sense to
  \item Write lines no longer than approximately 70 characters, and use line breaks if necessary
  \item Use simple English and short names for things that will be referenced frequently
  \item Add blank space around operators (e.g. \texttt{3 + 2 = 5} rather than \texttt{3+2=5})
  \item Indent \texttt{if} statements to allow the reader to scan the code more easily
  \item Comment code when necessary, but comments are not a solution for bad code
\end{itemize}

They note that for any system that may have a long lifespan, every effort
should be taken to improve ``readability and maintainability''. A project that
will only be used for a short amount of time by the original author does not
require as much attention to maintainability as one which will last several
years and be maintained by several different programmers.

\subsection{Web application frameworks}

% Intro to (web) frameworks in general

A framework is a certain amount of reusable code that helps application
developers by reducing the complexity of common web operations. For example,
any moderately complex application will need to write user input to a data
store, and protecting against malicious input is an obvious concern when
executing code in a database.

Many frameworks include functions that write to the database on behalf of the
developer, and will automatically sanitise all input to prevent against
attacks. As every application written should sanitise user input, it is this
kind of repetitive action that frameworks help ease. A useful framework should
increase the amount of time that a developer can spend building the unique
parts of their application.

A key focus of \gls{mvc} frameworks is to separate the application logic from
the interface that is presented to the user. The term MVC splits the
application into three pieces; the model for structuring and imposing
constraints on the data, the controller for manipulating the data into a
usable format and the view for presenting the manipulated data to the end user
in an understandable way.

Parr \cite{Parr2004templateengines} makes the point that separating the model
from the view is something developers strive for, but often fail to achieve.
He provides some good examples of software development patterns that should
never be seen, such as including \gls{sql} statements anywhere except the
model -- and even then, the framework should provide a mapping between
application objects and database structure.

He cites maintainability as a reason to strictly separate the view from both
the controller and the model, and as maintainability is a key focus of this
project (see Section~\ref{sec:maintainability}) this is clearly important.


The way in which the web application framework for this project was chosen is
discussed in Section~\ref{sec:webframeworks}.

\subsection{Sensitive information and the Data Protection Act}
\label{sec:dataprotection}

% As noted in the Statement of ethics, we should discuss Charles' input here.

The software created for the purpose of this project will manipulate students'
personal data, and as such the University's Data Protection Officer was
consulted during the requirements gathering, design and implementation. He
provided input on how the software should comply with all relevant legislation
-- this section outlines his input and resulting actions taken.

\noindent{\textbf{Automated decision making}}

Under Section 12 (Part II) of the Data Protection Act 1998 c.29, an individual
can request that no automated decisions are made that affect that individual.

For the purposes of this project, departments must notify students that their
modules will be allocated automatically -- words to this effect were placed in
the departmental student handbooks for this academic year, and will be
reinforced by email when students are asked to choose their modules.

The project steering group decided that any student who requests that their
modules are allocated manually will be treated as an exception. However, the
departments noted that it would be very hard to ensure every student was
treated fairly when some were allocated using the software and others were
not.

It is expected that only a tiny proportion of students would make this
request, if any. As in previous years, students will of course have the right
to appeal their module allocation if they feel it is unfair.

The relevant legislation is available in full at
\url{http://www.legislation.gov.uk/ukpga/1998/29/section/12}.

\noindent{\textbf{Retaining a memory}}

If data about students is retained, it will need to be held in line with
University policies and a data retention policy will have to be created for
this system.

\noindent{\textbf{Transferring data between systems}}

The Data Protection Act requires any transfer of data between University
systems to be secure and accurate.

The only data transferred to \gls{sits} will be module allocation information
for each student. As this is entirely the purpose of collecting the data from
students in the first place, it was felt that no further work would be needed
to ensure compliance with the Act.

\noindent{\textbf{Compromise of student data}}

The Data Protection Officer notes that \emph{any} data input by students into the
system is ``their personal data'', and any compromise of this data would be a
breach of the Data Protection Act.

The project implementer will work with \gls{itservices} during the creation of
the software. They will ensure as far as they can that there are no security
issues in the software that would cause personal information to be compromised.

Furthermore, the software will be restricted by the University firewall so
that it can only be accessed by a person with a University of York username
and password. While this does not completely remove any issue, it will reduce
the impact of any security problems with the software.

\input{sections/research_security.tex}

\subsection{User testing}

Jakob Nielsen is a web usability expert who has been publishing articles on
his website, \url{http://www.useit.com/}, since 1995. In ``Why You Only Need to
Test with 5 Users'', Nielsen asserts that usability tests should be run for all
web projects, no matter how short the project timescale or limited the budget.
This is especially relevant for a project such as the module allocation
system, where the entire application must be developed in under six months and
there is no budget allocated. Nielsen's advice is to run a single usability
test with no more than five volunteers, and to run different tests if more
participants can be recruited. His reasoning is that iterative design with
testing after each iteration will uncover any problems unwittingly created
during the development process. Finally, Nielsen points out that distinct
groups of users need to be treated separately during user testing
\cite{nielsen2000fiveusers}.

Nielsen Norman Group, a company founded by Nielsen with Don Norman in 1998,
publishes reports on web usability. Among the 230 tips offered in one such
report \cite{nng2001tipsusability}, Molich describes how to conduct user
testing sessions. The bulk of his recommendations are around making the test
participant feel comfortable during the session; this involves reassuring them
that they are not being tested, telling them that they should simply perform
the tasks as though they were at home and making the first task simple to
allow the participant to gain confidence.

Cennydd Bowles and James Box work for a web design agency based in Brighton.
In ``Undercover User Experience Design'', Bowles and Box describe various
methods of usability testing with little time or budget. They give advice on
asking questions in an unbiased way, so as not to influence the test. Like
Nielsen, they advocate around five user tests, stating that even one is better
than none. The authors suggest recording video (or, failing that, audio) of
the interview as there will not be enough time to take notes during the
session.

Bowles and Box put forward another method of eliciting information from users,
namely the corridor test. This involves watching people use the current system
for a very short amount of time and observing any usability issues they
encounter. The primary advantage of this type of test is that it takes very
little time or effort on both the part of the participant and the researcher
\cite{bowles2011undercover}.

In a 1982 paper titled ``Pitfalls of user research, and some neglected areas''
\cite{brittain1982pitfalls}, J. M. Brittain sets out the different kinds of
study that can be carried out during the research phase of any project. These
are publishing a questionnaire or interviewing users, asking users for any
input they have regarding a system or service, and observing users while they
perform a task. One point made by Brittain is that user research is
occasionally too narrow-focused -- in his example, the library was focusing
``upon the demands users make for documents'' without necessarily considering
how users read the documents once they are in possession of them. In the case
of the web, one could argue that user research focuses too much on the
specific task of interest and not on how users browse the web from day-to-day
or what they generally use the web for.

User research (interviews with potential users or the distribution of
questionnaires) should take place before the design phase in order to create a
desirable product. Kuniavsky \cite{kuniavsky2003userexperience} describes a
``family and friends usability test'' that he claims provides immediate
feedback on a prototype with minimal preparation and time required from the
research participant.

His key points for conducting a usability study are:

\begin{enumerate}
  \item Define your application's audience and the goals they want to achieve
  \item Create scenarios that will help them accomplish their goals
  \item Find test participants
  \item Observe them while they play out the scenarios defined
\end{enumerate}

Kuniavsky reinforces Molich's point that the most important consideration
during a usability test is that the participant is comfortable; for example,
that they understand it is not they who are being tested, but the application.
He says that participants should be strongly encouraged to narrate their
thought process as they use the application, as this provides useful insight
to the researcher when they review the studies later.

\subsection{Usability}

% http://www.faqs.org/docs/artu/ch11s01.html
% http://en.wikipedia.org/wiki/Principle_of_least_astonishment

In the past, web applications would \gls{post} data to the web server when the
user clicked a submit button. Modern web applications, such as Google's Gmail
email service, make use of JavaScript and fast Internet connections to
automatically save data to the server while the user is working. Sandlund
\cite{sandlund2009websoftware} explains that by automatically saving data at
regular intervals, there is far less chance of data loss. However, it is
important to include an explicit ``Save'' button on an application that
auto-saves -- one can imagine the confusion and uncertainty caused if the user
is unaware that their data is being saved in the background.

\begin{lstlisting}[language=HTML]
<input type="submit">
\end{lstlisting}

During Sandlund's user testing, participants responded positively to the
application automatically saving data. However, Sandlund decided not to
include a submit button in his application, and he notes that some users found
the lack of an explicit save button ``a bit disturbing''.

\input{sections/research_ilp.tex}

% \subsection{Unit testing and performance testing}
% 
% If there's time...

\section{Development, implementation and testing}
\label{sec:implementation}

% Several chapters describing what you have done, focusing on the novel
% aspects of your own work.

After reviewing the information gathered in the previous section, the software
was researched, written and tested. This section describes how users helped
influence the design of the software during interviews, a discussion on web
frameworks, the visual appearance and other important factors for web
projects. Information from departments that informed the allocation problem is
given, and the process surrounding the allocation is discussed.

\input{sections/development_user_research.tex}

\input{sections/development_database_structure.tex}

\subsection{Web application frameworks}
\label{sec:webframeworks}

% Justifying a framework for this project

While it is possible to build a web application without using a framework,
there is no advantage to rewriting basic operations for this project. If the
system needed to operate at a scale or speed far beyond what these frameworks
were capable of, it is likely that the software would have to be built from
scratch to meet those requirements.

With the limited amount of time allocated to development and implementation,
it is sensible to spend a small amount of time choosing a framework to allow
more time to implement the system.

%   Could reference the Gantt chart (if it's included) here.

\subsubsection{Framework language}

% The programming language

The most important consideration when choosing a framework is the language it
is written in, as this defines, among other things, how easy the software will
be to maintain in the future.

% ColdFusion ML
%   - http://www.york.ac.uk/communications/websites/content/programming/cms-integration/
% Java
% PHP
%   - http://www.york.ac.uk/it-services/facilities/web/php/

There are three languages used for most web development at the University of
York. \emph{ColdFusion Markup Language} (CFML) is a language for creating web pages,
the most popular commercial implementation of which is Adobe ColdFusion.
ColdFusion is used widely across the University, including in applications
such as the ``People Directory'' search tool (shown in
Figure~\ref{yorkacuk_directory_search}) and online account management
facilities. \emph{Java} was used in the creation of the new Student Portal. A
\emph{PHP} service is offered by the University for users to deploy their PHP
applications.

\begin{lstlisting}[language=HTML]
<cfparam name="attributes.userid" type="string" default="unknown">
<h1>Hello, world</h1>
<cfoutput>
  <p>Welcome, #HTMLEditFormat(attributes.userid)#.</p>
</cfoutput>
\end{lstlisting}

In a presentation at \gls{oscon} in 2007 \cite{raible2007javawebframeworks},
Matt Raible compared several web frameworks written in Java; JavaServer Faces
(JSF), Spring MVC, Stripes, Struts 2, Tapestry and Wicket.

While there are a wide variety of Java web application frameworks available,
the University of York has decided to use Spring, an open source framework
developed by a division of VMware (a virtualisation software provider). The
Spring framework has a \gls{mvc} component, making it entirely suitable for
this project. As this is a framework \gls{itservices} has deployed and can
support, it makes little sense to choose anything else.

CFML is unsuitable for this project as it is primarily a markup language -- the
allocation logic behind the application would have to be implemented in a
programming language such as Java or Python. Using two languages to create
this application would needlessly increase the complexity of any maintenance.

% Ruby
% Python

Outside the University of York, popular web programming languages include
\emph{Ruby} and \emph{Python}.

% Rails guesses the model's attributes based on the database schema, whereas
% Django requires that the model's attributes be listed in the application, and
% the schema is then created.
% 
% There's a good comparison of Django and Rails which is quite methodical. In
% it, the authors note that equivalent applications took $\frac{2}{3}$ the time
% to be implemented in Django than Rails \cite{RailsDjangoComparison_2007}.
% 
% There's also a good comparison of the three big players that pretty much rules
% out CakePHP as being rubbish \cite{EvalWebDevFrameworks_2009}.

\subsubsection{Summary}

The framework chosen for this project was Spring 3, written in Java. As the
application will be maintained by Java developers, it would not be sensible to
implement the software in another language only to possibly have to
re-implement using a different technology stack in the future.

Ruby or Python are both good languages for web application development, but
neither is suitable for this project as they cannot be maintained by
\gls{itservices}.

\subsection{Supporting software}

In addition to the web framework, there is a range of other software available
to support the creation of the application.

\subsubsection{Spring Roo}

Spring Roo is a \gls{rad} tool created by SpringSource (the Spring development team) to
aid developers in creating Java web applications. It works by providing an
executable, \texttt{roo}, which generates ``application scaffolding''
programmatically.

For example, inside Roo it is possible to run:

\begin{lstlisting}
project --topLevelPackage uk.ac.york.module_allocation
persistence setup --database MYSQL --provider HIBERNATE
entity --class ~.domain.Student
field string --fieldName username
\end{lstlisting}

These four lines of code generate a Java class representing a student complete
with setters and getters, 500 lines of XML configuration files and 20 lines of
application property files. It is also possible to generate a simple
\gls{crud} interface for displaying in the browser using the \texttt{web mvc
scaffold} command.

It is possible to tell from a brief glance that the code generated by Roo is
not as perfect as that which could be crafted by an expert Java developer. As
might be expected from a code generation tool, there is some unnecessary
repetition. The large amount of code generated results in a codebase that
feels fairly bloated, but the advantage is an application that is set up in
moments. As the generation tool is written by the Spring developers, one can
be assured that the code generated conforms to the basic standards of Spring.

The major concern when considering a generation tool such as Roo is the
lock-in that it entails. However, Chapter 6 of the Roo reference documentation
\cite{RooReferenceDocs2011} is titled ``Removing Roo''. In it, the authors
note that a key part of the Roo mission statement was ``without compromising
engineering integrity or flexibility''. The developers provide a simple,
three-step guide to removing Roo from the project. If the future maintainers
of this software require that it not include Roo, it will be easy to remove.

The benefits that Roo provides in the short-term far outweigh the time that
might need to be spent removing it.

\subsubsection{Templating engines}

% Additionally: iText PDF, JExcel, Jasper Reports, and XSLT are all supported
% by Spring

There are many different templating engines that can be used as components of
a Java (in this case, Spring) project. Examples of commonly-used Java
templating software include \gls{jsp}, Tiles and Freemarker.

% Plain old JSP

\gls{jsp} is a common language that is also used in Tiles. \gls{jsp} can be
used at a basic level to include dynamic elements in \gls{html}. The following
is an example of a \texttt{.jsp} file that outputs \gls{html} to the client:

\begin{lstlisting}[language=HTML]
<html>
  <h1>Welcome to the module allocation system, ${student_name}!</h1>
</html>
\end{lstlisting}

% Apache Tiles

Apache Tiles builds on just using \gls{jsp} markup by itself, by providing
other useful functions. Templates are written in the same language, but
developers can define `fragments' which are assembled when the page is
requested. The fragments (or tiles, which is where the software gets its name)
can be used to build up a page from its constituent parts. For example, it is
possible to define fragments for the page header and footer, to ensure they
are identical across every page. A template file may resemble the following,
where \texttt{header.jsp} and \texttt{footer.jsp} are files that contain the
site header and footer respectively:

\begin{lstlisting}[language=HTML]
<html>
  <tiles:insertTemplate path="/fragments/header.jsp" />
  <div id="container">
    <h1>This is the actual page content.</h1>
  </div>
  <tiles:insertTemplate path="/fragments/footer.jsp" />
</html>
\end{lstlisting}

% Freemarker

Freemarker is more complex than Tiles, but at the expense of not enforcing
complete separation between model and view:

\begin{lstlisting}[language=HTML]
<html>
  <#include "header.ftl" />
  <h1>Welcome to the module allocation system, ${student_name}!</h1>
  <p>These are the modules you have been allocated:</p>
  <ul>
  <#list modules as m>
    <li <#if m.level == "hard">class="hard"</#if>>${m.name} (${m.code})</li>
  </#list>
  </ul>
</html>
\end{lstlisting}

In his paper on enforcing separation between the model and the view, Parr
\cite{Parr2004templateengines} ranks Freemarker very poorly.

% StringTemplate

Parr has also created a templating engine, named StringTemplate, that enforces
separation of the model and the view. His paper articulates clearly why
enforcing the separation between model and view is a positive for a web
application, and his argument is convincing. As would be expected, his
templating engine is strict about applying the constraints he argues in favour
of in his paper.

% \subsubsection{Database thingys}

% EclipseLink or Hibernate

\subsection{Design decisions and visual appearance}

The application should be visually consistent with other University web
software to instill trust in the user.

The University's Web Office (part of the Communications Office) was contacted
to enquire whether the application should be branded using the standard green
banner, or as a part of the student portal.

% Following the principle of least astonishment...

% http://en.wikipedia.org/wiki/Principle_of_least_astonishment

\begin{figure}
  \begin{center}
    \includegraphics[width=160mm]{images/2011_11_06_yorkacuk.png}
  \end{center}
  \caption{A general page on the University site, using University colours}
  \label{yorkacuk_general_page}
\end{figure}

\begin{figure}
  \begin{center}
    \includegraphics[width=160mm]{images/2011_11_06_yorkacuk_directory.png}
  \end{center}
  \caption{The University of York People Directory search tool}
  \label{yorkacuk_directory_search}
\end{figure}

% Include screenshots of University software:
%   https://www.york.ac.uk/it-services/facilities/account/accounts
%   https://www.cs.york.ac.uk/submit/assessment/
%   https://www.york.ac.uk/students/

One area that usability gains can be made are in relation to how the
application saves data. During one of the user research sessions, the
participant explained that while choosing optional modules during her first
year, she neglected to press that application's ``OK'' button and, unaware
that she had not submitted choices, was unable to take her preferred modules.

As an explicit ``Save'' button should be retained to reduce surprise and allow
the user to feel in control, the most sensible decision is to automatically
save user input periodically and notify users that their choices are being
saved. The submit button would save data in case of failure of the automatic
save mechanism.

\subsection{Accessibility}

% http://www.york.ac.uk/communications/websites/policies/accessibility/

Educational institutions such as the University of York are required by the
\gls{senda} 2001 to ensure that web content is accessible to disabled users.
The Web Office provides advice to those publishing web sites or applications
on behalf of the University at
\url{http://www.york.ac.uk/communications/websites/content/accessibility/}.
While this advice is more applicable to content-heavy areas such as department
websites for student recruitment, it still contains some things to consider
while building a web application.

% Perceivable
% Operable
% Understandable
% Robust

The two major accessibility issues surrounding a web application are users who
are visually impaired and users who are unable to use a keyboard and/or mouse
to browse the web.

To mitigate the first accessibility issue, the application was tested to
ensure that users can increase the page or font size to fit their needs. Users
who use custom style sheets in their web browser (for example to enhance
contrast) are able to do so.

All text and background colour combinations were tested to ensure compliance
with WCAG AAA.

% http://www.snook.ca/technical/colour_contrast/colour.html

As to the second accessibility issue, generally speaking users who are unable
to use a keyboard or mouse do not use JavaScript in their web browser. The
application is designed so that users with JavaScript disabled are instead
presented a simple form layout that can be read out to them by screen-reading
software and filled in solely with a keyboard (which can be voice controlled).

It is thought with these considerations, every student will be able to use the
system to select their modules. However, even if the above fallbacks fail the
student will still be able to obtain help from their department (which could
complete the module selection on their behalf). The aim is that no student
will be stranded with an application they cannot use and no instructions
telling them how to gain assistance.

% Finally, the student interface was tested by Mr David Swallow, a Research
% Associate in the \gls{hci} research group at the University of York. Mr
% Swallow commented that ``on the whole, the accessibility of the application
% is excellent and passes many of the checkpoints where other applications
% slip up''. He did, however, note several minor issues with the application.

\subsection{Interaction with other University software}

The system will be required to interact with \gls{sits}, as this is the
centrally maintained database that must always contain a true and accurate
representation of a student's data. Data stored in \gls{sits} is throughout
the University, including for timetabling and room allocation.

This system will interact with data stored in \gls{sits} at two points:

\begin{enumerate}
  \item Module and student data must be imported during setup
  \item Module allocation data must be exported after the allocation algorithm has run
\end{enumerate}

The import and setup will be performed by departmental administrators. This
decision was taken to reduce the amount of time required from \gls{ssdt},
especially as administrators will need to spend time tailoring the system to
their department after the import has taken place.

For the pilot of this module allocation software, the data produced by the
application will be processed manually by \gls{mh}. They will
perform a ``sanity check'' to ensure that the data generated by the
application looks accurate and will import the data. If this application is
evaluated successfully and maintained centrally, it will not be feasible to
import the data manually for each department and some kind of automatic import
will have to be developed (Section~\ref{sec:autoexport}).

\input{sections/development_algorithm.tex}

\input{sections/development_assistance_its.tex}

\subsection{Issues arising during implementation}
\label{sec:issuesarising}

% Discuss some of the _real_ issues of a _real_ project

\noindent{\textbf{Availability of stakeholders}}

One of the most positive aspects of undertaking this project was in fact one
of the most difficult -- that is, the project was designed to work very
closely with the University of York and as such relied on ``real''
stakeholders.

An issue arose fairly early in the project when it became clear that some
administrative staff (both IT support staff and those in the pilot
departments) would be away from work for prolonged periods of time or would
leaving their jobs during the creation of this application. This caused delays
while the replacement staff had to be brought up to speed on the background
and current state of the project.

The issue was mitigated with the help of the \gls{aso}, which was responsible
for assisting with issues not directly related to implementation. The new or
replacement staff were then invited to group meetings so that they could keep
up to speed with recent developments and provide any necessary input. As
implementation began to finish, departmental administrators were provided
training on the software by the project implementer. A deputy was present at
the training sessions so that the software could still be used in case of
unforeseen circumstances rendering the departmental administrator unable to
set up the software.

% \noindent{\textbf{Lack of technical contacts available during the project}}

% I first met the Head of Web Services and an \gls{itservices} developer on 16
% January, several months after the project had begun. This meant that the
% amount of time allocated to implementation was reduced. If a project of this
% nature was to be carried out in future, the technical contact
% (\gls{itservices} developers in the case of the University of York) should
% be involved as early as possible. The author if of the opinion that earlier
% involvement from a developer would have resulted in the developer actually
% spending less time assisting with the project.

\noindent{\textbf{Inability to interact with the system while it contained sensitive data}}

% @todo were there bugs?

The project implementer was unable to respond to bugs in a timely manner as
it was not possible for \gls{itservices} to provide access to a database and
platform containing live student data. This made bug fixing during the week
the application was open to students nearly impossible.

The process surrounding bug fixing during the week the application was open
was as follows:

\begin{enumerate}
  \item An error is reported by a student to their departmental administrator
  \item The administrator contacts both \gls{itservices} and the project implementer
  \item They liaise (in order to provide redacted log files, if necessary)
  \item The software is patched by the project implementer
  \item The patched software is deployed by \gls{itservices}
\end{enumerate}

Note that as soon as (1) had taken place, the department could perform the
student's ranking for them using functionality built into the software - the
student was not simply left unable to make their choices.

Because of the dependency between the various different people involved in the
project, fixing a bug was a process that took several hours. While releasing a
patched application in a matter of hours is relatively uncommon in, for
example, desktop software development, it is a long time for a web application
that is only in use for a week.

The web application was only available for a week, or about 120 waking hours.
Under the assumption that the use of the application by the 800 students was
distributed uniformly over time, a several hour period during which the
software was not fully functional might inconvenience approximately forty
students.

The project implementer signed a non-disclosure agreement with regards to the
student data involved in the system, but ultimately it was still felt by the
University that an undergraduate student could not be given access to other
students' personal data.

\noindent{\textbf{Unfamiliarity with the language and framework}}

While the framework was chosen based on its maintainability as
University-owned software, the project implementer was not particularly
familiar with the underlying language and framework. This made it hard to
estimate the amount of time that various stages of implementation would take.
If this project was to be undertaken again, the implementer should first use a
language they are familiar with to prototype the application quickly, and then
use any remaining time to re-implement in a language that can be maintained by
the future software owners.

This would require almost double the implementation effort (though parts, such
as the user experience and some front-end code, could be reused across
frameworks) but should allow the implementer to provide clients with a working
application far in advance of any deadlines. When developing using unfamiliar
software, the developer is dependent on how fast they are able to learn and
use new techniques.

\input{sections/development_testing.tex}

\subsection{Software overview}

This section of the report gives an overview of the feature-complete software
including a walkthrough of the entire selection and allocation process.

\emph{[@todo Include screenshots and a brief walkthrough of the software]}

% A video of the software in use on a touchscreen device is available at...?

\input{sections/development_pilot.tex}

\section{Further work}
\label{sec:furtherwork}

% A chapter describing possible ways in which your work could be continued or
% developed. Be imaginative but realistic.

% We should probably ask departments what they'd like to see in the future.

There were many feature requests from the project steering group that I had
insufficient time to implement during the course of the project. These
requests (including their difficulty and potential implementation strategy)
are discussed in this section.

\subsection{Maintaining a history}

While considering the data protection implications mentioned in
Section~\ref{sec:dataprotection}, a popular request from the pilot departments
was that the application should retain its knowledge about a student for the
duration of their time at university.

One obvious benefit of this improvement is that the fairness of the allocation
for a given student could be improved over the course of their academic
career. For example, if a student was given one of their lower ranked modules
in the first year, the allocation could compensate them by giving them
preference over other students for a higher ranked module in the second
year.

The University's Data Protection Officer would have to be consulted in order
to draft a suitable retention policy for this additional data. It seems that
this is data that a department might be expected to collect and reference, and
as such could be held in line with the department's retention policies.

\subsection{Different methods of obtaining information from students}

One mockup created during the user testing allowed students to weight modules
rather than ranking them -- it was thought by the project steering group that
this interface (Figure~\ref{prototype_student_weighting}) would allow students
to express more clearly their preferences for certain modules (i.e. the
student could use the bars to demonstrate that they have a very strong desire
for module X, and absolutely do not want to be allocated module Y).

However, user testing revealed that students were confused about how the
values shown on the bars would be used to allocate modules. Furthermore, a
concern raised at both the project steering group meetings and by students
during testing was that this nuanced a selection process might evolve into a
``bidding war'' between students, with a student adding one or two points to
the values their peers had input in order to secure a module.

In summary, there was strong feedback from the test groups that the
application should in fact be kept as simple as possible -- the phrase
\gls{kiss} is often used.

It is possible that an interface similar to the one prototyped could be
further refined such that students are comfortable using it -- the project
group and implementer still believe it could provide a ``better'' allocation
for students. A simple solution could perhaps be to not display the exact
percentage figures to students so that they are choosing modules based on the
approximate lengths of the bars rather than the exact values.

\subsection{Automatic import and export}
\label{sec:autoexport}

The application could be extended so that it automatically accesses data
stored in the University's Data Warehouse. This would be far easier for an
experienced University developer to implement than it would be for the project
author, who has no prior experience writing software to integrate with
University of York infrastructure.

This would remove the need for departments to set up the application by
uploading files and, crucially, would remove the requirement that \gls{ssdt}
must import the data into \gls{sits} when the allocation is complete. The
result of this integration would be a further reduction in administrative time
required.

\subsection{Expanding the use of the application}

The Chair of Board of Studies in Archaeology posed the question of whether
this application could be used to allow visiting students to select their
modules.

The application has been designed in such a way that any course, no matter
what the structure, can be added. The only blocking factor for this use case
is that the application requires a University of York login to authenticate
with Shibboleth. A standalone version of the application could be created
with its own authentication mechanism, which would avoid this requirement.

\subsection{Interface improvements}

As different departments have their own requirements for the algorithm, it
would be nice if they could manipulate small parameters in the algorithm
themselves.

The student interface should undergo further testing on less commonly used
devices. It should also be tested using screen reading software to ensure that
all accessibility requirements have been met, and improved in that regard if
required.

\subsection{Contacting students}

During user testing, one benefit students noted compared to the paper system
is that it is significantly easier for them to keep a record of the choices
made.

Currently, the system simply advises students to print or save the page that
is displayed after they have made their choices. An obvious improvement to
this process is that students could be emailed a copy of their choices. This
would confirm to the student that their input has definitely been saved, while
also giving them a copy of their choices.

\subsection{Support for more complex course structures}

Several departments have complex course structures, for example where a module
in one term influences the module that must be taken in the next term. The
interface could be extended to reflect this.

% \subsection{Further testing}
% 
% There was not sufficient time during the period allocated to development to
% write detailed unit tests or carry out performance testing.

\subsection{Other minor features}

There are countless other minor features that could be implemented. For
example, the system currently records a timestamp for every student when they
save their choices. It may be interesting (though is not at all required) for
the departments to be able to see at what point during the allocation period
the students are making their choices, so graphing this information may be
useful.

\input{sections/conclusion.tex}

\clearpage
\appendix

\stdsection{Participant consent form}
\label{sec:consent}

All research participants (students and staff of the University of York)
signed the consent form shown in Figure~\ref{participantconsent} immediately
before their interview took place. This consent form is adapted from one made
available by Alistair Edwards for Computer Science students to use during
their projects. As of 5 November 2011, the original is available at
\url{http://www-users.cs.york.ac.uk/~alistair/projects/consent.html}.

In each case, the top half of the form was retained by the project author and
the second half was given to the participant in case they had any further
questions about the interview.

\begin{figure}
  \begin{center}
    \fbox{\includegraphics[width=0.9\linewidth]{images/consent.pdf}}
  \end{center}
  \caption{Participant consent form}
  \label{participantconsent}
\end{figure}

\stdsection{Confidentiality and non-disclosure agreement}
\label{sec:nda}

The \gls{nda} shown in Figure~\ref{confidentialitynda} was signed by the
project implementer and the Head of Web Services at the University of York.

\begin{figure}
  \begin{center}
    \fbox{\includegraphics[width=0.9\linewidth]{inc/itservices_nda.pdf}}
  \end{center}
  \caption{University of York confidentiality and non-disclosure agreement}
  \label{confidentialitynda}
\end{figure}

\stdsection{Prototypes of the student interface}
\label{sec:prototypes}

Figures~\ref{prototype_student_1col}, \ref{prototype_student_weighting} and
\ref{prototype_student_2col} give screenshots of the prototypes created for
the student interface for ranking modules.

Note that the explanatory copy included in the screenshots was drafted
by the project implementer and was revised by the departments prior to the
system being in use.

\begin{figure}
  \begin{center}
    \includegraphics[width=0.85\linewidth]{images/prototypes/student_prototype_1.png}
  \end{center}
  \caption{Prototype of a drag-and-drop ranking based system}
  \label{prototype_student_1col}
\end{figure}

\begin{figure}
  \begin{center}
    \includegraphics[width=0.85\linewidth]{images/prototypes/student_prototype_2.png}
  \end{center}
  \caption{Prototype of draggable bars for a weighting based system}
  \label{prototype_student_weighting}
\end{figure}

\begin{figure}
  \begin{center}
    \includegraphics[width=0.85\linewidth]{images/prototypes/student_prototype_3.png}
  \end{center}
  \caption{Prototype of a drag-and-drop two-column ranking based system}
  \label{prototype_student_2col}
\end{figure}

\stdsection{Feedback from test users}
\label{sec:testingfeedback}

\subsection{Focus groups with students}

\begin{itemize}
  \item Students have the expectation that they should have to rank every module
  \item The two-column layout is similar to the way \gls{yusu} voting works
  \item The system should send an email confirmation to students
\end{itemize}

\subsection{Final application on development server}

Table~\ref{table:finalissues} gives final issues in the application discovered
while it was hosted on the development server.

\begin{table}[h]
  \begin{center}
    \begin{tabular}{ | l | l | }
      \hline
      \textbf{Issue summary}                & \textbf{Times raised}  \\
      \hline
      Form validation improvements                         &    3    \\
      Random ordering of confirmation screen               &    2    \\
      Parts of explanatory text unclear                    &    2    \\
      Students should not be required to rank every module &    1    \\
      \hline
    \end{tabular}
  \end{center}
  \caption{Issues raised with the final release of the application}
  \label{table:finalissues}
\end{table}

\stdsection{Application documentation}
\label{sec:documentation}

The following documentation was provided to every departmental administrator
in advance of the application being open to students (27 February). It was
also used as the basis for the \gls{itservices} security review that is
discussed in Section~\ref{sec:securityreview} (15 February).

\includepdf[pages=-, frame=true, nup=2, landscape=true]{inc/documentation.pdf}


\stdsection{Gurobi Python prototype}
\label{sec:gurobipythonprototype}

\lstset{language=Python}
\lstinputlisting{listings/gurobi_allocation_prototype.py}


\clearpage
\printglossaries

\clearpage
\bibliographystyle{references/IEEEtran.bst} % not just plain
\bibliography{references/references.bib}
\addcontentsline{toc}{section}{References}


\end{document}
